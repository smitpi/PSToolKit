<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="Pierre Smit">
    <link rel="canonical" href="https://smitpi.github.io/PSToolKit/Remove-HiddenDevice/">
    <link rel="shortcut icon" href="../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Remove-HiddenDevice - PSToolKit</title>
    <link href="../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-3.2.1.min.js"></script>
    <script src="../js/bootstrap-3.3.7.min.js"></script>
    <script src="../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Remove-HiddenDevice", url: "#_top", children: [
              {title: "SYNOPSIS", url: "#synopsis" },
              {title: "SYNTAX", url: "#syntax" },
              {title: "DESCRIPTION", url: "#description" },
              {title: "EXAMPLES", url: "#examples" },
              {title: "PARAMETERS", url: "#parameters" },
              {title: "INPUTS", url: "#inputs" },
              {title: "OUTPUTS", url: "#outputs" },
              {title: "NOTES", url: "#notes" },
              {title: "RELATED LINKS", url: "#related-links" },
          ]},
        ];

    </script>
    <script src="../js/base.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../Remove-UserProfile/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../Remove-UserProfile/" class="btn btn-xs btn-link">
        Remove-UserProfile
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../Remove-FaultyProfileList/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../Remove-FaultyProfileList/" class="btn btn-xs btn-link">
        Remove-FaultyProfileList
      </a>
    </div>
    
  </div>

    

    <h1 id="remove-hiddendevice">Remove-HiddenDevice</h1>
<h2 id="synopsis">SYNOPSIS</h2>
<p>Removes ghost devices from your system</p>
<h2 id="syntax">SYNTAX</h2>
<div class="highlight"><pre><span></span><code>Remove-HiddenDevice [[-FilterByClass] &lt;Array&gt;] [[-FilterByFriendlyName] &lt;Array&gt;] [-listDevicesOnly]
 [-listGhostDevicesOnly] [&lt;CommonParameters&gt;]
</code></pre></div>
<h2 id="description">DESCRIPTION</h2>
<p>Removes ghost devices from your system</p>
<h2 id="examples">EXAMPLES</h2>
<h3 id="example-1">EXAMPLE 1</h3>
<div class="highlight"><pre><span></span><code>Lists all devices
</code></pre></div>
<p>.
Remove-HiddenDevices -listDevicesOnly</p>
<h3 id="example-2">EXAMPLE 2</h3>
<div class="highlight"><pre><span></span><code>Save the list of devices as an object
</code></pre></div>
<p>$Devices = .
Remove-HiddenDevices -listDevicesOnly</p>
<h3 id="example-3">EXAMPLE 3</h3>
<div class="highlight"><pre><span></span><code>Lists all &#39;ghost&#39; devices
</code></pre></div>
<p>.
Remove-HiddenDevices -listGhostDevicesOnly</p>
<h3 id="example-4">EXAMPLE 4</h3>
<div class="highlight"><pre><span></span><code>Save the list of &#39;ghost&#39; devices as an object
</code></pre></div>
<p>$ghostDevices = .
Remove-HiddenDevices -listGhostDevicesOnly</p>
<h3 id="example-5">EXAMPLE 5</h3>
<div class="highlight"><pre><span></span><code>Remove all ghost devices EXCEPT any devices that have &quot;Intel&quot; or &quot;Citrix&quot; in their friendly name
</code></pre></div>
<p>.
Remove-HiddenDevices -filterByFriendlyName @("Intel","Citrix")</p>
<h3 id="example-6">EXAMPLE 6</h3>
<div class="highlight"><pre><span></span><code>Remove all ghost devices EXCEPT any devices that are apart of the classes &quot;LegacyDriver&quot; or &quot;Processor&quot;
</code></pre></div>
<p>.
Remove-HiddenDevices -filterByClass @("LegacyDriver","Processor")</p>
<h3 id="example-7">EXAMPLE 7</h3>
<div class="highlight"><pre><span></span><code>Remove all ghost devices EXCEPT for devices with a friendly name of &quot;Intel&quot; or &quot;Citrix&quot; or with a class of &quot;LegacyDriver&quot; or &quot;Processor&quot;
</code></pre></div>
<p>.
Remove-HiddenDevices -filterByClass @("LegacyDriver","Processor") -filterByFriendlyName @("Intel","Citrix")</p>
<h2 id="parameters">PARAMETERS</h2>
<h3 id="-filterbyclass">-FilterByClass</h3>
<p>This parameter will exclude devices that match the class name provided.
This parameter needs to be specified in an array format for all the class names you want to be excluded from removal.
This is an exact string match so "Disk" will not match "DiskDrive".</p>
<div class="highlight"><pre><span></span><code><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Array</span><span class="w"></span>
<span class="nt">Parameter Sets</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">(All)</span><span class="w"></span>
<span class="nt">Aliases</span><span class="p">:</span><span class="w"></span>

<span class="nt">Required</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span><span class="w"></span>
<span class="nt">Position</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span><span class="w"></span>
<span class="nt">Default value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">None</span><span class="w"></span>
<span class="nt">Accept pipeline input</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span><span class="w"></span>
<span class="nt">Accept wildcard characters</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span><span class="w"></span>
</code></pre></div>
<h3 id="-filterbyfriendlyname">-FilterByFriendlyName</h3>
<p>This parameter will exclude devices that match the partial name provided.
This parameter needs to be specified in an array format for all the friendly names you want to be excluded from removal.
"Intel" will match "Intel(R) Xeon(R) CPU E5-2680 0 @ 2.70GHz".
"Loop" will match "Microsoft Loopback Adapter".</p>
<div class="highlight"><pre><span></span><code><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Array</span><span class="w"></span>
<span class="nt">Parameter Sets</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">(All)</span><span class="w"></span>
<span class="nt">Aliases</span><span class="p">:</span><span class="w"></span>

<span class="nt">Required</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span><span class="w"></span>
<span class="nt">Position</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span><span class="w"></span>
<span class="nt">Default value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">None</span><span class="w"></span>
<span class="nt">Accept pipeline input</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span><span class="w"></span>
<span class="nt">Accept wildcard characters</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span><span class="w"></span>
</code></pre></div>
<h3 id="-listdevicesonly">-listDevicesOnly</h3>
<p>listDevicesOnly will output a table of all devices found in this system.</p>
<div class="highlight"><pre><span></span><code><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SwitchParameter</span><span class="w"></span>
<span class="nt">Parameter Sets</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">(All)</span><span class="w"></span>
<span class="nt">Aliases</span><span class="p">:</span><span class="w"></span>

<span class="nt">Required</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span><span class="w"></span>
<span class="nt">Position</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Named</span><span class="w"></span>
<span class="nt">Default value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span><span class="w"></span>
<span class="nt">Accept pipeline input</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span><span class="w"></span>
<span class="nt">Accept wildcard characters</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span><span class="w"></span>
</code></pre></div>
<h3 id="-listghostdevicesonly">-listGhostDevicesOnly</h3>
<p>listGhostDevicesOnly will output a table of all 'ghost' devices found in this system.</p>
<div class="highlight"><pre><span></span><code><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SwitchParameter</span><span class="w"></span>
<span class="nt">Parameter Sets</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">(All)</span><span class="w"></span>
<span class="nt">Aliases</span><span class="p">:</span><span class="w"></span>

<span class="nt">Required</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span><span class="w"></span>
<span class="nt">Position</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Named</span><span class="w"></span>
<span class="nt">Default value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span><span class="w"></span>
<span class="nt">Accept pipeline input</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span><span class="w"></span>
<span class="nt">Accept wildcard characters</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span><span class="w"></span>
</code></pre></div>
<h3 id="commonparameters">CommonParameters</h3>
<p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see <a href="http://go.microsoft.com/fwlink/?LinkID=113216">about_CommonParameters</a>.</p>
<h2 id="inputs">INPUTS</h2>
<h2 id="outputs">OUTPUTS</h2>
<h2 id="notes">NOTES</h2>
<p>Permission level has not been tested. 
It is assumed you will need to have sufficient rights to uninstall devices from device manager for this script to run properly.</p>
<h2 id="related-links">RELATED LINKS</h2>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../Remove-UserProfile/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../Remove-UserProfile/" class="btn btn-xs btn-link">
        Remove-UserProfile
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../Remove-FaultyProfileList/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../Remove-FaultyProfileList/" class="btn btn-xs btn-link">
        Remove-FaultyProfileList
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="container-fluid wm-page-content">
      <p>
        <a href="https://github.com/smitpi/PSToolKit/edit/master/docs/Remove-HiddenDevice.md">Edit on smitpi/PSToolKit</a>
      </p><p>(c) 2022 Pierre Smit. All rights reserved.</p>
  <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>